Actor ExShotgun : Weapon
{
  Inventory.PickupSound "PS/Ipickup2"
  inventory.pickupmessage "You got the shotgun!"
  Obituary "%o was killed by %k."
  Weapon.selectionorder 1000
  Weapon.BobStyle Smooth
  Weapon.BobRangeX 0.75
  Weapon.BobRangeY 0.28
  Weapon.BobSpeed 1.4	  
  Weapon.AmmoType "Shell"
  Weapon.AmmoGive 8
  Weapon.AmmoUse 1
  Weapon.SlotNumber 2
  Inventory.RestrictedTo "PSPlayer"
  Tag "Shotgun"    
  states
  {
  Ready:
    EXSH A 1 A_WeaponReady
    loop
  Deselect: 
    EXSH A 1 A_Lower
    loop
  Select:
    EXSH A 1 A_Raise
    loop
  Fire:
	TNT1 A 0 A_JumpIfInventory("PSShellDummy",8,"Reload")
	TNT1 A 0 A_GiveInventory("PSShellDummy",1)
    EXSH A 1
	EXSH B 2 offset(-1,36) BRIGHT A_PlaySound("Jon/ShotgunFire",CHAN_WEAPON)
	EXSH B 1 offset(0,37) BRIGHT
	TNT1 A 0 A_Quake(3,2,0,16,"")
	TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,2)
    EXSH C 1 offset(-1,36)BRIGHT A_FireBullets (4,4,7,15,"PSBulletPuff", FBF_NORANDOM|FBF_USEAMMO)
	Goto A
    EXSH C 1 offset(-1,36)BRIGHT A_FireBullets (4,4,7,15,"PSBulletPuffCoop", FBF_NORANDOM|FBF_USEAMMO)
  A:	
    EXSH C 1 offset(0,37)BRIGHT 
    EXSH C 1 offset(1,38)BRIGHT 
    EXSH C 1 offset(2,39)BRIGHT
    EXSH A 1 offset(3,40)	
    EXSH A 1 offset(2,39)
    EXSH A 1 offset(1,38)	
    EXSH A 1 offset(1,37)
    EXSH A 1 offset(0,37)	
	EXSH A 1 offset(0,37)	
	EXSH A 1 offset(0,32)	
	EXSH A 2
	TNT1 A 0 A_JumpIfInventory("PSShellDummy",8,"Reload")	
	EXSH F 4
	EXSH G 5 A_PlaySound("Jon/ShotgunCock",CHAN_BODY)
	EXSH F 4
	EXSH G 5
	EXSH F 3
    EXSH A 1 A_ReFire
    Goto Ready  
  Reload:
	TNT1 A 0 A_JumpIfInventory("Shell",1,"DoReload")
	Goto Ready
  DoReload:
	TNT1 A 0 A_PlaySound("Jon/SReload1",CHAN_WEAPON)
	EXSH H 3 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH I 3 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	TNT1 AAAAAAAA 0 A_FireCustomMissile("ExShellCasing",-45+frandom(-10.00,10.00),0,1,8+frandom(-1.10,1.10),0)	
	EXSH J 3 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	TNT1 A 0 A_PlaySound("Jon/SReload2",CHAN_WEAPON)
	EXSH K 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH L 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH M 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH J 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	TNT1 A 0 A_PlaySound("Jon/SReload2",CHAN_WEAPON)
	EXSH K 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH L 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH M 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)	
	EXSH J 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	TNT1 A 0 A_PlaySound("Jon/SReload2",CHAN_WEAPON)
	EXSH K 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH L 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH M 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)	
	EXSH J 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	TNT1 A 0 A_PlaySound("Jon/SReload2",CHAN_WEAPON)
	EXSH K 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH L 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH M 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)	
	EXSH J 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	TNT1 A 0 A_PlaySound("Jon/SReload2",CHAN_WEAPON)
	EXSH K 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH L 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH M 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)	
	EXSH J 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	TNT1 A 0 A_PlaySound("Jon/SReload2",CHAN_WEAPON)
	EXSH K 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH L 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH M 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)	
	EXSH J 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	TNT1 A 0 A_PlaySound("Jon/SReload2",CHAN_WEAPON)
	EXSH K 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH L 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH M 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)	
	EXSH J 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	TNT1 A 0 A_PlaySound("Jon/SReload2",CHAN_WEAPON)
	EXSH K 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH L 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH M 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)		
	EXSH I 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH H 3 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)	
	TNT1 A 0 A_TakeInventory("PSShellDummy",8)
    EXSH A 3 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)	
	TNT1 A 0 A_PlaySound("Jon/ShotgunCock",CHAN_WEAPON)
	EXSH G 3 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)	
	EXSH F 3 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH G 3 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH F 3 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)	
	EXSH A 3 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	EXSH A 2 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE|WRF_NOSWITCH)
	Goto Ready
  Spawn:
    EX_T A -1
    stop
  }
}

Actor PSShellDummy : Inventory { Inventory.Amount 1 Inventory.MaxAmount 8 }
Actor PSBullet2 : PSBullet1 { Damage (15) }
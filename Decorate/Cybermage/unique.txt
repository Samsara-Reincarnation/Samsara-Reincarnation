Actor RandomMagicItem : CustomInventory
{
	inventory.amount 0
	inventory.maxamount 0
	+INVENTORY.UNDROPPABLE
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
    +INVBAR
    Inventory.PickupMessage "Icon of Mann-ra!"
	Inventory.RestrictedTo "CMPlayer"
	States
	{
		Spawn:
			CMUQ A -1 bright
			Stop
		Use:
			TNT1 A 0
			TNT1 A 0 A_Jump(256,"Magic1", "Magic2", "Magic3", "Magic4")
			Stop
		Magic1:
			TNT1 A 0 A_Print("Wheel of Magic! You got the Electroschism (Clip) Spell! *Requires 5 of said ammo*")
			TNT1 A 0 A_GiveInventory("MagicMode1", 1)
			TNT1 A 0 A_GiveInventory("Clip", 40)
			TNT1 A 0 A_GiveInventory("AllowMeDoSwitch1",1)
			Stop
		Magic2:
			TNT1 A 0 A_Print("Wheel of Magic! You got the Magna Rip (Shell) Spell! *Requires 3 of said ammo*")
			TNT1 A 0 A_GiveInventory("MagicMode2", 1)
			TNT1 A 0 A_GiveInventory("Shell", 18)
			TNT1 A 0 A_GiveInventory("AllowMeDoSwitch2",1)			
			Stop
		Magic3:
			TNT1 A 0 A_Print("Wheel of Magic! You got the Painwave (Rocket) Spell! *Requires 4 of said ammo*")
			TNT1 A 0 A_GiveInventory("MagicMode3", 1)
			TNT1 A 0 A_GiveInventory("RocketAmmo", 20)
			TNT1 A 0 A_GiveInventory("AllowMeDoSwitch3",1)			
			Stop
		Magic4:
			TNT1 A 0 A_Print("Wheel of Magic! You got the Nova (Cell) Spell! *Requires 40 of said ammo*")
			TNT1 A 0 A_GiveInventory("MagicMode4", 1)
			TNT1 A 0 A_GiveInventory("Cell", 80)
			TNT1 A 0 A_GiveInventory("AllowMeDoSwitch4",1)			
			Stop
	  }
}		

Actor MagicMode0 : Inventory { inventory.maxamount 1 }
Actor MagicMode1 : MagicMode0 { }
Actor MagicMode2 : MagicMode0 { }
Actor MagicMode3 : MagicMode0 { }
Actor MagicMode4 : MagicMode0 { }
Actor AllowMeDoSwitch1 : MagicMode0 { }
Actor AllowMeDoSwitch2 : MagicMode0 { }
Actor AllowMeDoSwitch3 : MagicMode0 { }
Actor AllowMeDoSwitch4 : MagicMode0 { }
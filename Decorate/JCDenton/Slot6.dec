Actor DeusEx_FlameThrowerMagazine : Ammo
{
	+INVENTORY.IGNORESKILL
	Inventory.Amount 1
	Inventory.MaxAmount 100 
}


Actor DeusEx_FlameThrower : DeusExWeapon // horrifically overpowered. will have to rethink later.
{
	Weapon.SelectionOrder 1600
	Weapon.SlotNumber 6
	Weapon.SlotPriority 1
	Weapon.AmmoType1 "DeusEx_FlameThrowerMagazine"
	Weapon.AmmoUse1 1
	Weapon.AmmoType2 "Cell"
	Weapon.AmmoUse2 0
	Weapon.AmmoGive1 0
	Weapon.AmmoGive2 100
	Tag "FlameThrower"
	Weapon.UpSound "DeusEx/FlameThrower/Select"
	Inventory.PickupMessage "You found a FlameThrower."
	Obituary "%o was burned to a crisp with %k's FlameThrower."
	States
	{
		Spawn:
			DX03 A -1
			Stop
		Select:
			TNT1 AAAAAAAAAAAAAAAAAAAA 0 A_Raise
			TNT1 A 1 A_Raise
			loop
	    Ready:
			//DX00 B 0 A_JumpIfInventory("DeusEx_HeavyWeaponSkill", 2, 2)
			DX00 B 0 A_GiveInventory("DeusEX_FlameThrowerEquipped", 1) //ACS_NamedExecuteAlways("DeusEx_Decorate", 0, 3)		
			DX00 BCDEFGHI 3
			DX00 I 0 A_TakeInventory("DeusEx_Reloading", 1)
			Goto ReadyLoop
		ReadyLoop:
			DX01 H 1 A_WeaponReady(WRF_ALLOWRELOAD) DX01 H 0 A_Jump(4, "IdleAnimation")
			Loop
		Fire:
			DX01 L 0 A_JumpIfInventory("DeusEx_FlameThrowerMagazine", 1, "Fire2")
			Goto FireReload
		Fire2:
			DX00 J 0 A_PlaySound("DeusEx/FlameThrower/Fire", CHAN_WEAPON)
			DX00 J 0 A_AlertMonsters(1000)
			DX00 J 0 A_GunFlash
			DX00 JKL 4 A_WeaponReady(WRF_NOSWITCH|WRF_NOFIRE)
			DX00 L 2 A_Refire(1)
			Goto ReadyLoop
			DX01 M 0 A_JumpIfInventory("DeusEx_FlameThrowerMagazine", 1, 1)
			Goto FireReload
			DX00 M 0 A_GunFlash
			DX00 MNO 4 A_WeaponReady(WRF_NOSWITCH|WRF_NOFIRE)
			DX00 O 2 A_Refire(1)
			Goto ReadyLoop
			DX01 P 0 A_JumpIfInventory("DeusEx_FlameThrowerMagazine", 1, 1)
			Goto FireReload
			DX00 P 0 A_PlaySound("DeusEx/FlameThrower/Fire", CHAN_WEAPON)
			DX00 P 0 A_GunFlash
			DX00 PON 4 A_WeaponReady(WRF_NOSWITCH|WRF_NOFIRE)
			DX00 N 2 A_Refire(1)
			Goto ReadyLoop
			DX01 M 0 A_JumpIfInventory("DeusEx_FlameThrowerMagazine", 1, 1)
			Goto FireReload
			DX00 M 0 A_GunFlash
			DX00 MLK 4 A_WeaponReady(WRF_NOSWITCH|WRF_NOFIRE)
			DX00 K 2 A_Refire(1)
			Goto ReadyLoop
			DX01 K 0 A_JumpIfInventory("DeusEx_FlameThrowerMagazine", 1, 1)
			Goto FireReload
			DX00 K 0 A_GunFlash("Flash2")
			DX00 KJ 4 A_WeaponReady(WRF_NOSWITCH|WRF_NOFIRE)
			DX00 J 2 A_Refire("Fire")
			Goto ReadyLoop
		Flash:
			TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"FlashCoop")
			TNT1 A 0 A_JumpIfInventory("DMModeOn",1,"FlashDM")
			TNT1 AAAAAAAAAAAA 1 A_FireCustomMissile("DeusEx_Fireball", 0, 1, 8, 2)
			Stop
		FlashCoop:
			TNT1 AAAAAAAAAAAA 1 A_FireCustomMissile("DeusEx_FireballCoop", 0, 1, 8, 2)
			Stop
		FlashDM:
			TNT1 AAAAAAAAAAAA 1 A_FireCustomMissile("DeusEx_FireballDM", 0, 1, 8, 2)
			Stop
		Flash2:
			TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Flash2Coop")
			TNT1 A 0 A_JumpIfInventory("DMModeOn",1,"Flash2DM")
			TNT1 AAAAAAAA 1 A_FireCustomMissile("DeusEx_Fireball", 0, 1, 8, 2)
			Stop
		Flash2Coop:
			TNT1 AAAAAAAA 1 A_FireCustomMissile("DeusEx_FireballCoop", 0, 1, 8, 2)
			Stop
		Flash2DM:
			TNT1 AAAAAAAA 1 A_FireCustomMissile("DeusEx_FireballDM", 0, 1, 8, 2)
			Stop
		FireReload:
			DX01 H 0 A_PlaySound("DeusEx/DryFire", CHAN_WEAPON)
			DX01 HHH 1
			DX01 H 1 A_ClearRefire
			Goto Reload
		IdleAnimation:
			DX01 IJKLMNO 6 A_WeaponReady(WRF_ALLOWRELOAD)
			DX01 PQRST 6 A_WeaponReady(WRF_ALLOWRELOAD)
			Goto ReadyLoop
		Reload:
			DX00 Z 0 A_JumpIfInventory("DeusEx_FlameThrowerMagazine", 0, "ReadyLoop")
			DX00 Z 0 A_JumpIfInventory("Cell", 1, "ReloadSuccess")
			Goto ReadyLoop
		ReloadSuccess:	
			DX00 Q 0 A_GiveInventory("DeusEx_Reloading", 1)
			DX00 Q 3 A_PlaySound("DeusEx/Flamethrower/Reload1", CHAN_WEAPON)
			DX00 RST 3 A_WeaponReady(WRF_NOFIRE)
			DX00 U 0 A_JumpIfInventory("DeusEx_HeavyWeaponSkill", 4, 15)
			DX00 U 0 A_JumpIfInventory("DeusEx_HeavyWeaponSkill", 3, 10)
			DX00 U 0 A_JumpIfInventory("DeusEx_HeavyWeaponSkill", 2, 6)
			DX00 U 0 A_JumpIfInventory("DeusEx_HeavyWeaponSkill", 1, 3)				
			DX00 UVWXYZUVWXYZUVW 4 A_WeaponReady(WRF_NOFIRE)
			Goto ReloadAmmo
		ReloadAmmo:
			TNT1 A 0 A_JumpIfInventory("DeusEx_FlameThrowerMagazine",0,"ReloadFinish")
			TNT1 A 0 A_JumpIfInventory("Cell",1,1)
			goto ReloadFinish
			TNT1 A 0 A_GiveInventory("DeusEx_FlameThrowerMagazine",2)
			TNT1 A 0 A_TakeInventory("Cell",1,TIF_NOTAKEINFINITE)
			loop
		ReloadFinish:
			DX00 "[" 0 A_PlaySound("DeusEx/Flamethrower/Reload2", CHAN_WEAPON)
			DX00 "[" 0 A_TakeInventory("DeusEx_Reloading", 1)
			DX00 "[\]" 3
			Goto ReadyLoop
		Deselect:
			DX01 A 0 A_GiveInventory("DeusEx_Reloading", 1)
			DX01 ABCDE 4
			DX01 F 4 A_TakeInventory("DeusEX_FlamethrowerEquipped", 999) //ACS_NamedExecuteAlways("DeusEx_Decorate", 0, 4)
			Goto Super::InstantDeselect
	}
}

Actor DeusEx_FireBall
{
	PROJECTILE
	Radius 6
	Height 5
	Speed 25
	Damage (CallACS("DeusEx_WeaponSkillDamage", 5, 5))
	PoisonDamageType "DeusExFlamed"
	PoisonDamage 5, 30, 35 //can't scale up poison damage =(
	RenderStyle Add
	Alpha 0.9
//	+RIPPER
	+BLOODLESSIMPACT
	+FORCERADIUSDMG
	+HITTRACER
	DamageType "DeusExFlamed"
	Scale 0.15
	States
	{
		Spawn:
			DX03 ABCDABCD 2 BRIGHT
			Stop
		XDeath:
			TNT1 A 0 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 5, 5),12,!XF_HURTSOURCE,0,12)
		Crash:
		Death:
			DX03 ABCD 2 BRIGHT A_FadeOut(0.2)
			Stop
	}
}

Actor DeusEx_FireBallCoop : DeusEx_FireBall { Species "Player" +THRUSPECIES }

Actor DeusEx_FireBallDM : DeusEx_FireBall { PoisonDamage 0, 0, 0 }